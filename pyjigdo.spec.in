%{!?python_sitelib: %define python_sitelib %(python -c "from distutils.sysconfig import get_python_lib; print get_python_lib()")}

%define gitdate %(date +20071127)

Summary:        Python version of Jigdo, slightly modified
Name:           pyjigdo
Version:        0.2
Release:        2.%{gitdate}git%{?dist}
License:        GPLv2+
Group:          Applications/System
URL:            https://hosted.fedoraproject.org/projects/pyjigdo
Source0:        http://files.pyjigdo.fedoraunity.org/%{name}-%{version}.tar.gz
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
Requires:       jigdo
# this is because we use /var/tmp/jigdo
BuildArch:      noarch
BuildRequires:  intltool, gettext, python, diffutils

%description
PyJigdo is a Python rewrite of the popular Jigdo distribution framework. It has
also been slightly modified to add some extra features.

%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
%doc README NEWS AUTHORS COPYING TODO
%doc %{_mandir}/man5/*
%doc %{_mandir}/man8/*
%{python_sitelib}/pyjigdo/
%{_bindir}/*
%dir %{_sysconfdir}/pyjigdo
%config(noreplace) %{_sysconfdir}/pyjigdo/pyjigdo.conf

%changelog
* Tue Nov 27 2007 Stewart Adam <s.adam a diffingo.com> 0.2-2.20071127git
- Fix %%changelog date, drop automatic gitdate

* Fri Nov 23 2007 Stewart Adam <s.adam a diffingo.com> 0.2-2.20071123git
- Use gitdate

* Wed Oct 10 2007 Stewart Adam <s.adam a diffingo.com> 0.2-1
- Split up py files
- License change from GPLv2 to GPLv2+
- Make __init__.py's __version__ work based on automake

* Tue Oct 09 2007 Jonathan Steffan <jon a fedoraunity.org> 0.1-2
- Updated spec to build for alpha test release

* Sun Oct 07 2007 Jonathan Steffan <jon a fedoraunity.org> 0.1-1
- Initial spec

